# 리눅스 프로세스와 시스템 기초

## 프로세스(Process)

- **프로세스**: 실행중인 프로그램
- **프로세스 번호(PID)**: 각 프로세스는 유일한 프로세스 번호 PID를 갖음
- **부모 프로세스**: 각 프로세스는 부모 프로세스에 의해 생성됨

### 프로세스의 종류
- **시스템 프로세스**: 시스템 운영에 필요한 기능을 수행하는 프로세스 (데몬 프로세스)
- **사용자 프로세스**: 사용자의 명령 혹은 프로그램을 실행시키기 위해 생성된 프로세스

## 프로세스 관련 명령어

### ps (Process Status)
```bash
$ ps [-옵션]
```
- 현재 시스템 내에 존재하는 프로세스들의 실행 상태를 요약해서 출력

**사용 예:**
```bash
$ ps
PID TTY TIME CMD
1519 pts/3 00:00:00 bash
1551 pts/3 00:00:00 ps

$ ps -f
UID PID PPID C STIME TTY TIME CMD
chang 1519 1518 0 17:40 pts/3 00:00:00 /bin/bash
chang 1551 1519 0 17:40 pts/3 00:00:00 ps –f
```

**ps 출력 정보:**

| 항목 | 의미 |
|------|------|
| UID | 프로세스를 실행시킨 사용자 ID |
| PID | 프로세스 번호 |
| PPID | 부모 프로세스 번호 |
| C | 프로세스의 우선순위 |
| STIME | 프로세스의 시작 시간 |
| TTY | 명령어가 시작된 터미널 |
| TIME | 프로세스에 사용된 CPU 시간 |
| CMD | 실행되고 있는 명령어(프로그램) 이름 |

### pgrep (Process Grep)
```bash
$ pgrep [옵션] [패턴]
```
- 패턴에 해당하는 프로세스들만을 리스트함

**주요 옵션:**
- `-l` : PID와 함께 프로세스의 이름을 출력
- `-f` : 명령어의 경로도 출력
- `-n` : 패턴과 일치하는 프로세스들 중에서 가장 최근 프로세스만을 출력
- `-x` : 패턴과 정확하게 일치되는 프로세스만 출력
- `-a` : 전체 명령어 줄과 PID를 출력

**사용 예:**
```bash
$ pgrep sshd
5032

$ pgrep -l sshd
5032 sshd

$ pgrep -ln sshd
5032 sshd
```

## 프로세스 제어

### 후면 처리 (Background Processing)
```bash
$ 명령어 &
```

**예시:**
```bash
$ sleep 10 &
[1] 6530
$ ps
PID TTY TIME CMD
1519 pts/0 00:00:00 bash
6530 pts/0 00:00:00 sleep
6535 pts/0 00:00:00 ps
```

### 프로세스 종료/제어
- **강제종료**: `Ctrl-C`
- **실행 정지**: `Ctrl-Z`

### fg (Foreground)
```bash
$ fg
```
- 정지된 작업을 다시 전면에서 실행시킴

```bash
$ fg %작업번호
```
- 작업번호에 해당하는 후면 작업을 전면 작업으로 전환

### bg (Background)
```bash
$ bg %작업번호
```
- 작업번호에 해당하는 중지된 작업을 후면 작업으로 전환하여 실행

### 후면 작업의 입출력 제어
```bash
# 후면 작업의 출력
$ 명령어 > 출력파일 &
$ find . -name test.c -print > find.txt &
$ find . -name test.c -print | mail chang &

# 후면 작업의 입력
$ 명령어 < 입력파일 &
```

### kill (프로세스 종료)
```bash
$ kill 프로세스번호
$ kill %작업번호
```
- 프로세스 번호(혹은 작업 번호)에 해당하는 프로세스를 강제로 종료

**예시:**
```bash
$ (sleep 100; echo done) &
[1] 8320
$ kill 8320
# 또는
$ kill %1
[1] 종료됨 ( sleep 100; echo done )
```

### wait (프로세스 기다리기)
```bash
$ wait [프로세스번호]
```
- 프로세스 번호로 지정한 자식 프로세스가 종료될 때까지 기다림
- 지정하지 않으면 모든 자식 프로세스가 끝나기를 기다림

## 프로세스 우선순위

- 실행 우선순위 nice 값: 19(제일 낮음) ~ -20(제일 높음)
- 보통 기본 우선순위 0으로 명령어를 실행

### nice 명령어
```bash
$ nice [-n 조정수치] 명령어 [인수들]
```
- 주어진 명령을 조정된 우선순위로 실행

**예시:**
```bash
$ nice  # 현재 우선순위 출력
0
$ nice -n 10 ps –ef  # 조정된 우선순위로 실행
```

### renice (우선순위 조정)
```bash
$ renice [-n] 우선순위 [-gpu] PID
```
- 이미 수행중인 프로세스의 우선순위를 명시된 우선순위로 변경
- `-g`: 해당 그룹명 소유로 된 프로세스를 의미
- `-u`: 지정한 사용자명의 소유로 된 프로세스를 의미
- `-p`: 해당 프로세스의 PID를 지정

## 프로세스의 사용자 ID

- 프로세스는 사용자 ID와 그룹 ID를 갖음
- 그 프로세스를 실행시킨 사용자의 ID와 사용자의 그룹 ID
- 프로세스가 수행할 수 있는 연산을 결정하는 데 사용

### id 명령어
```bash
$ id [사용자명]
```
- 사용자의 실제 ID와 유효 사용자 ID, 그룹 ID 등을 보여줌

### 프로세스의 ID 유형
- **실제 사용자 ID(real user ID)**: 프로세스를 실행시킨 사용자의 ID
- **유효 사용자 ID(effective user ID)**: 현재 유효한 사용자 ID (주로 파일 접근 권한 확인 시 사용)

## Set-User-ID 및 Set-Group-ID

### set-user-id 실행파일
- set-user-id가 설정된 실행파일을 실행하면 이 프로세스의 유효 사용자 ID는 그 실행파일의 소유자로 바뀜
- 이 프로세스는 실행되는 동안 그 파일의 소유자 권한을 갖게 됨

**실행 과정 예시:**
- `/bin/passwd` 파일은 set-user-id 실행권한이 설정된 실행파일이며 소유자는 root
- 일반 사용자가 이 파일을 실행하면 이 프로세스의 유효 사용자 ID는 root가 됨
- 유효 사용자 ID가 root이므로 root만 수정할 수 있는 암호 파일 `/etc/shadow` 파일을 접근하여 수정 가능

### set-group-id 실행파일
- 실행되는 동안에 그 파일 소유자의 그룹이 프로세스의 유효 그룹 ID가 됨
- set-group-id 실행권한은 8진수 모드로는 2000으로 표현

### 설정 방법
```bash
# set-user-id 실행권한 설정
$ chmod 4755 파일 
# 또는
$ chmod u+s 파일

# set-group-id 실행권한 설정
$ chmod 2755 파일
# 또는
$ chmod g+s 파일
```

## 인터넷과 서버

### LAN(Local Area Network)
- 근거리 통신망으로 집, 사무실, 학교 등의 건물과 같이 가까운 지역을 한데 묶는 컴퓨터 네트워크
- **이더넷(Ethernet)**: 제록스 PARC에서 개발된 LAN 구현 방법, 현재 가장 일반적으로 사용

### 네트워크 장치
- **라우터(router)**: 두 개 이상의 네트워크를 연결하는 장치, 데이터 패킷의 경로를 지정
- **게이트웨이(Gateway)**: 일종의 고용량 라우터로 LAN을 인터넷에 연결하는 장치
- **무선 액세스 포인트(WAP)**: 네트워크에서 와이파이, 블루투스 등을 이용하여 무선 장치들을 유선망에 연결하는 장치

### TCP/IP 프로토콜
- **IP(Internet Protocol)**: 호스트의 주소지정과 패킷 분할 및 조립 기능에 대한 규약
- **TCP(Transport Control Protocol)**: IP 위에서 동작하는 프로토콜로, 데이터의 전달을 보증하고 보낸 순서대로 받게 해줌

### 호스트명과 IP 주소
```bash
$ hostname  # 사용중인 시스템의 호스트명을 출력
$ ip addr   # 사용중인 시스템의 IP 주소를 출력
```

### DNS(Domain Name System)
- 호스트명을 IP 주소로 번역하는 서비스 (전화번호부와 유사)

```bash
$ nslookup 호스트명  # 지정된 호스트의 IP 주소를 알려줌
```

## 네트워크 서비스

### FTP(File Transfer Protocol)
```bash
$ ftp -n [호스트명]
$ sftp -n [호스트명]
```
- 호스트명으로 지정된 FTP 서버에 접속하여 파일을 업로드 혹은 다운로드

### telnet
```bash
$ telnet 호스트명(혹은 IP 주소)
```
- 지정된 원격 호스트에 원격으로 접속

### ssh(secure shell)
```bash
$ ssh 사용자명@호스트명
$ ssh -l 사용자명 호스트명
```
- 지정된 원격 호스트에 사용자명으로 원격으로 안전하게 접속
- 보안을 위해 강력한 인증 및 암호화 기법 사용

### ping
```bash
$ ping 호스트명
```
- 지정된 원격 호스트가 도달 가능한지 테스트하여 상태를 확인

## 파일 유틸리티

### find 명령어
```bash
$ find 디렉터리 [-옵션]
```
- 옵션의 검색 조건에 따라 지정된 디렉터리 아래에서 해당되는 파일들을 모두 찾아 출력

**주요 검색 조건:**
- **파일명**: `$ find 디렉터리 -name 파일명 -print` 또는 `-ls`
- **소유자**: `$ find . -user chang -print`
- **파일 크기**: `$ find . -size +1024 -print`
- **파일 종류**: `$ find ~ -type d -print`
  - d: 디렉터리
  - f: 일반 파일
  - l: 심볼릭 링크
  - b: 블록 장치 파일
  - c: 문자 장치 파일
  - s: 소켓 파일
- **접근권한**: `$ find . -perm 700 -ls`
- **파일 접근/수정 시간**:
  - `$ find . -atime +30 -print`
  - `$ find . -mtime -7 -print`

### grep 명령어
```bash
$ grep 패턴 파일*
```
- 파일(들)을 대상으로 지정된 패턴의 문자열을 검색하고, 해당 문자열을 포함하는 줄들을 출력

**주요 옵션:**

| 옵션 | 기능 |
|------|------|
| -i | 대소문자를 무시하고 검색 |
| -l | 해당 패턴이 들어있는 파일 이름을 출력 |
| -n | 각 줄의 줄번호도 함께 출력 |
| -v | 명시된 패턴을 포함하지 않는 줄을 출력 |
| -c | 패턴과 일치하는 줄 수를 출력 |
| -w | 패턴이 하나의 단어로 된 것만 검색 |

**정규식:**

| 문자 | 의미 | 예 |
|------|------|------|
| . | 임의의 한 문자 | 'a...b'는 a로 시작해서 b로 끝나는 5글자 문자열 |
| * | 바로 앞의 것을 0번 이상의 반복 | 'a*b'는 b, ab, aab, aaab, ... 등의 문자열 |
| [ ] | [과 ] 사이의 문자 중 하나 | '[abc]d'는 ad, bd, cd를 뜻함 |
| [^...] | [^ 과 ] 사이의 문자를 제외한 나머지 문자 중 하나 | '[^abc]d'는 ad, bd, cd는 포함하지 않고 ed, fd 등은 포함 |
| ^, $ | 각각 줄의 시작과 끝 | '^문자열'은 문자열로 시작하는 줄, '문자열$'은 문자열로 끝나는 줄 |

## Bash 쉘 스크립트

### Bash(Bourne-again shell)
- 리눅스, 맥 OS X 등의 운영 체제의 기본 쉘
- Bash 문법은 본 쉘의 문법을 대부분 수용하면서 확장

**시작 파일(start-up file):**
- `/etc/profile`: 전체 사용자에게 적용되는 환경 설정, 시작 프로그램 지정
- `/etc/bash.bashrc`: 전체 사용자에게 적용되는 별명과 함수들을 정의
- `~/.bash_profile`: 각 사용자를 위한 환경을 설정, 시작 프로그램 지정
- `~/.bashrc`: 각 사용자를 위한 별명과 함수들을 정의

### 별명(alias)
```bash
$ alias 이름=문자열
$ alias dir='ls –aF'
$ alias h=history
$ alias ll='ls –l'

# 현재까지 정의된 별명들을 확인
$ alias

# 이미 정의된 별명 해제
$ unalias 단어
```

### 히스토리(history)
```bash
$ history [-rh] [번호]
```
- 기억할 히스토리의 크기: `$ HISTSIZE=100`
- 로그아웃 후에도 히스토리가 저장되도록 설정: `$ HISTFIESIZE=100`

**재실행:**

| 형태 | 의미 |
|------|------|
| !! | 바로 전 명령 재실행 |
| !n | 이벤트 번호가 n인 명령 재실행 |
| !시작스트링 | 시작스트링으로 시작하는 최후 명령 재실행 |
| !?서브스트링 | 서브스트링을 포함하는 최후 명령 재실행 |

### 환경변수와 지역변수
- **환경 변수**: 값이 자식 프로세스에게 상속됨
- **지역변수**: 자식 프로세스에게 상속되지 않음

**사전 정의 환경변수:**

| 이름 | 의미 |
|------|------|
| $USER | 사용자 이름 |
| $TERM | 터미널 타입 |
| $PATH | 명령어를 검색할 디렉터리들의 리스트 |
| $HOME | 홈 디렉터리 |
| $SHELL | 로그인 쉘의 경로명 |
| $MAIL | 메일 박스의 경로명 |
| $HOSTNAME | 호스트 이름 |

**사전 정의 지역 변수:**

| 이름 | 의미 |
|------|------|
| $$ | 쉘의 프로세스 번호 |
| $0 | 쉘 스크립트 이름 |
| $1 ~ $9 | 명령줄 인수 |
| $* | 모든 명령줄 인수 리스트 |
| $# | 명령줄 인수의 개수 |

## 프로그래밍 환경

### gedit 문서편집기
- GNU의 대표적인 GUI 텍스트 편집기
- GNOME 환경의 기본 편집기
- 텍스트, 프로그램 코드, 마크업 언어 편집에 적합
- 깔끔하고 단순한 GUI

**실행 방법:**
- 메인 메뉴: [프로그램] -> [보조 프로그램] -> [지에디트]
- 터미널: `$ gedit [파일이름] &`
- 파일 관리자: 텍스트 파일 클릭하면 자동실행

**주요 메뉴:**
- **파일**: 새로 만들기, 열기, 저장, 되돌리기, 인쇄
- **편집**: 입력 취소, 다시 실행, 잘라내기, 복사, 붙여넣기, 삭제
- **보기**: 도구모음, 상태표시줄, 전체화면, 강조 모드
- **검색**: 찾기, 바꾸기, 줄로 이동
- **도구**: 맞춤법 검사, 오타가 있는 단어 강조, 언어 설정, 문서 통계
- **문서**: 모두 저장, 모두 닫기, 새 탭 그룹, 이전 문서

### 다중 모듈 프로그램
- **단일 모듈 프로그램**: 코드의 재사용이 어렵고, 여러 사람이 참여하는 프로그래밍이 어려움
- **다중 모듈 프로그램**: 여러 개의 .c 파일들로 이루어진 프로그램, 복잡하고 대단위 프로그램에 적합

### make 시스템
- 다중 모듈 프로그램을 구성하는 일부 파일이 변경된 경우, 변경된 파일만 다시 컴파일하여 실행 파일을 만듦
- 대규모 프로그램의 경우 헤더, 소스 파일, 목적 파일, 실행 파일의 모든 관계를 관리

```bash
$ make [-f 메이크파일]
```
- make 시스템은 메이크파일(makefile 혹은 Makefile)을 이용하여 실행 파일을 빌드

### vi 에디터
- 기본 텍스트 에디터로 매우 강력한 기능을 가지고 있으나 배우는데 시간과 노력 필요
- **명령 모드/입력 모드**: vi 에디터는 두 모드가 구분되어 있으며 시작하면 명령 모드

**마지막 줄 모드:**
- `:wq` 작업 내용을 저장하고 종료 (ZZ와 동일한 기능)
- `:q` 아무런 작업을 하지 않은 경우의 종료
- `:q!` 작업 내용을 저장하지 않고 종료
